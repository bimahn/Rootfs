"use strict";"require baseclass";"require fs";"require rpc";var callLuciVersion=rpc.declare({object:"luci",method:"getVersion"});var callSystemBoard=rpc.declare({object:"system",method:"board"});var callSystemInfo=rpc.declare({object:"system",method:"info"});function getBrandFromCgi(){return fetch('/cgi-bin/ipinfo',{cache:'no-store'}).then(r=>r.ok?r.text():'').then(t=>(t||'').trim()||'MUTIARA-WRT').catch(()=>'MUTIARA-WRT')}
return baseclass.extend({title:_("System"),load:function(){return Promise.all([L.resolveDefault(callSystemBoard(),{}),L.resolveDefault(callSystemInfo(),{}),L.resolveDefault(callLuciVersion(),{revision:_("unknown version"),branch:"LuCI"}),getBrandFromCgi()])},render:function(data){var boardinfo=data[0],systeminfo=data[1],luciversion=data[2],brand=data[3];luciversion=luciversion.branch+" "+luciversion.revision;var datestr=null;if(systeminfo.localtime){var date=new Date(systeminfo.localtime*1000);datestr="%04d-%02d-%02d %02d:%02d:%02d".format(date.getUTCFullYear(),date.getUTCMonth()+1,date.getUTCDate(),date.getUTCHours(),date.getUTCMinutes(),date.getUTCSeconds())}
var model=boardinfo.model;var modelInfo=(model||"Unknown")+" "+brand;var fields=[_("Model"),modelInfo,_("Firmware Version"),(L.isObject(boardinfo.release)?boardinfo.release.description+" | ":"")+(luciversion||""),_("Kernel Version"),boardinfo.kernel,_("Local Time"),datestr,_("Uptime"),systeminfo.uptime?"%t".format(systeminfo.uptime):null,_("Temperature"),tempcpu,_("CPU Usage"),cpuusage];var table=E("table",{class:"table"});for(var i=0;i<fields.length;i+=2){table.appendChild(E("tr",{class:"tr"},[E("td",{class:"td left",width:"33%"},[fields[i]]),E("td",{class:"td left"},[fields[i+1]!=null?fields[i+1]:"?"])]))}
return table},})